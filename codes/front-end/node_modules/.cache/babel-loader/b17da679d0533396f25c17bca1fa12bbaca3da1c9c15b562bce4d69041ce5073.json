{"ast":null,"code":"import Vue from 'vue';\nimport ElementUI from 'element-ui';\nimport 'element-ui/lib/theme-chalk/index.css';\nimport App from './App.vue';\nimport router from './router';\nimport axios from 'axios';\nVue.use(ElementUI);\nVue.config.productionTip = false;\nconst isTokenValid = token => {\n  try {\n    const decoded = jwtDecode(token);\n    const currentTime = Date.now() / 1000;\n    return decoded.exp > currentTime;\n  } catch (error) {\n    return false;\n  }\n};\nconst token = localStorage.getItem('token');\nif (token && isTokenValid(token)) {\n  axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n} else {\n  // Token无效或不存在，重定向到登录页面\n  window.location.href = '/login';\n}\n\n//\n//localStorage.setItem('access_token','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJtaW1hIiwiZXhwIjoxNzE3NTc0MzQ1fQ.AUveZm50ocFsR-boQdgdmOQGDb5zvLp5nyj-8S2tyLU')\n\n// 添加请求拦截器\naxios.interceptors.request.use(config => {\n  // 从 localStorage 获取 token\n  const token = localStorage.getItem('access_token');\n  console.log('Token:', token); // 检查 token 是否存在\n  if (token) {\n    // 在请求头中添加 token，使用小写的 bearer\n    config.headers.Authorization = `bearer ${token}`;\n  }\n  console.log('Request Headers:', config.headers); // 检查请求头\n  return config;\n}, error => {\n  // 对请求错误做些什么\n  return Promise.reject(error);\n});\nVue.prototype.axios = axios;\nnew Vue({\n  router,\n  render: h => h(App)\n}).$mount('#app');","map":{"version":3,"names":["Vue","ElementUI","App","router","axios","use","config","productionTip","isTokenValid","token","decoded","jwtDecode","currentTime","Date","now","exp","error","localStorage","getItem","defaults","headers","common","window","location","href","interceptors","request","console","log","Authorization","Promise","reject","prototype","render","h","$mount"],"sources":["H:/projects/task-manage-system/codes/front-end/src/main.js"],"sourcesContent":["import Vue from 'vue';\r\nimport ElementUI from 'element-ui';\r\nimport 'element-ui/lib/theme-chalk/index.css';\r\nimport App from './App.vue';\r\nimport router from './router';\r\nimport axios from 'axios';\r\n\r\nVue.use(ElementUI);\r\n\r\nVue.config.productionTip = false;\r\n\r\nconst isTokenValid = (token) => {\r\n  try {\r\n    const decoded = jwtDecode(token);\r\n    const currentTime = Date.now() / 1000;\r\n    return decoded.exp > currentTime;\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n};\r\n\r\nconst token = localStorage.getItem('token');\r\n\r\nif (token && isTokenValid(token)) {\r\n  axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n} else {\r\n  // Token无效或不存在，重定向到登录页面\r\n  window.location.href = '/login';\r\n}\r\n\r\n\r\n//\r\n//localStorage.setItem('access_token','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJtaW1hIiwiZXhwIjoxNzE3NTc0MzQ1fQ.AUveZm50ocFsR-boQdgdmOQGDb5zvLp5nyj-8S2tyLU')\r\n\r\n// 添加请求拦截器\r\naxios.interceptors.request.use(config => {\r\n  // 从 localStorage 获取 token\r\n  const token = localStorage.getItem('access_token');\r\n  console.log('Token:', token);  // 检查 token 是否存在\r\n  if (token) {\r\n    // 在请求头中添加 token，使用小写的 bearer\r\n    config.headers.Authorization = `bearer ${token}`;\r\n  }\r\n  console.log('Request Headers:', config.headers);  // 检查请求头\r\n  return config;\r\n}, error => {\r\n  // 对请求错误做些什么\r\n  return Promise.reject(error);\r\n});\r\n\r\nVue.prototype.axios = axios;\r\n\r\nnew Vue({\r\n  router,\r\n  render: h => h(App)\r\n}).$mount('#app');\r\n\r\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAO,sCAAsC;AAC7C,OAAOC,GAAG,MAAM,WAAW;AAC3B,OAAOC,MAAM,MAAM,UAAU;AAC7B,OAAOC,KAAK,MAAM,OAAO;AAEzBJ,GAAG,CAACK,GAAG,CAACJ,SAAS,CAAC;AAElBD,GAAG,CAACM,MAAM,CAACC,aAAa,GAAG,KAAK;AAEhC,MAAMC,YAAY,GAAIC,KAAK,IAAK;EAC9B,IAAI;IACF,MAAMC,OAAO,GAAGC,SAAS,CAACF,KAAK,CAAC;IAChC,MAAMG,WAAW,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI;IACrC,OAAOJ,OAAO,CAACK,GAAG,GAAGH,WAAW;EAClC,CAAC,CAAC,OAAOI,KAAK,EAAE;IACd,OAAO,KAAK;EACd;AACF,CAAC;AAED,MAAMP,KAAK,GAAGQ,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AAE3C,IAAIT,KAAK,IAAID,YAAY,CAACC,KAAK,CAAC,EAAE;EAChCL,KAAK,CAACe,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUZ,KAAK,EAAE;AACpE,CAAC,MAAM;EACL;EACAa,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;AACjC;;AAGA;AACA;;AAEA;AACApB,KAAK,CAACqB,YAAY,CAACC,OAAO,CAACrB,GAAG,CAACC,MAAM,IAAI;EACvC;EACA,MAAMG,KAAK,GAAGQ,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;EAClDS,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEnB,KAAK,CAAC,CAAC,CAAE;EAC/B,IAAIA,KAAK,EAAE;IACT;IACAH,MAAM,CAACc,OAAO,CAACS,aAAa,GAAG,UAAUpB,KAAK,EAAE;EAClD;EACAkB,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEtB,MAAM,CAACc,OAAO,CAAC,CAAC,CAAE;EAClD,OAAOd,MAAM;AACf,CAAC,EAAEU,KAAK,IAAI;EACV;EACA,OAAOc,OAAO,CAACC,MAAM,CAACf,KAAK,CAAC;AAC9B,CAAC,CAAC;AAEFhB,GAAG,CAACgC,SAAS,CAAC5B,KAAK,GAAGA,KAAK;AAE3B,IAAIJ,GAAG,CAAC;EACNG,MAAM;EACN8B,MAAM,EAAEC,CAAC,IAAIA,CAAC,CAAChC,GAAG;AACpB,CAAC,CAAC,CAACiC,MAAM,CAAC,MAAM,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}